<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jallipalli Phani Kumar - Digital Analytics Consultant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #1E40AF; /* Tailwind blue-700 */
            --color-accent: #3B82F6;  /* Tailwind blue-500 */
            --color-bg-dark: #0A0A0A; /* Deep Black */
            --color-card-dark: #1F2937; /* Tailwind gray-800 */
            --color-text-light: #F3F4F6; /* Tailwind gray-100 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg-dark);
            color: var(--color-text-light);
        }
        .section-header {
            border-left: 4px solid var(--color-accent);
            padding-left: 1rem;
            margin-bottom: 2rem;
            display: inline-block;
        }
        .skill-badge {
            transition: all 0.2s;
            cursor: default;
        }
        .skill-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .timeline-item {
            position: relative;
            padding-left: 2rem;
            border-left: 2px solid #374151; /* gray-700 */
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 0;
            width: 16px;
            height: 16px;
            background-color: var(--color-accent);
            border-radius: 50%;
            border: 3px solid var(--color-bg-dark);
        }
        .card {
            background-color: var(--color-card-dark);
            transition: all 0.3s;
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <header class="sticky top-0 z-50 bg-[rgba(10,10,10,0.95)] backdrop-blur-sm shadow-xl shadow-gray-900/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="#hero" class="text-2xl font-bold tracking-tight text-white hover:text-blue-400 transition">Phani.Dev</a>
            <nav class="hidden md:flex space-x-6">
                <a href="#about" class="text-gray-300 hover:text-blue-400 transition text-sm font-medium">About</a>
                <a href="#skills" class="text-gray-300 hover:text-blue-400 transition text-sm font-medium">Skills</a>
                <a href="#experience" class="text-gray-300 hover:text-blue-400 transition text-sm font-medium">Experience</a>
                <a href="#projects" class="text-gray-300 hover:text-blue-400 transition text-sm font-medium">Projects</a>
                <a href="#contact" class="text-gray-300 hover:text-blue-400 transition text-sm font-medium">Contact</a>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- 1. Hero Section -->
        <section id="hero" class="py-24 md:py-36 text-center">
            <div class="max-w-3xl mx-auto">
                <p class="text-blue-400 text-sm tracking-widest uppercase mb-4">Digital Analytics & ML Specialist</p>
                <h1 class="text-5xl sm:text-7xl font-extrabold leading-tight mb-6">
                    Jallipalli <span class="text-blue-500">Phani Kumar</span>
                </h1>
                <p class="text-xl text-gray-400 mb-8">
                    Experienced Consultant with 3+ years in <span class="font-semibold text-white">Adobe Analytics, GA4, Adobe Launch, and GTM</span>. Bridging the gap between data strategy and technical implementation to drive measurable business growth.
                </p>
                <div class="flex justify-center space-x-4">
                    <a href="#contact" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg shadow-blue-500/50 transition duration-300 transform hover:scale-[1.02]">
                        Hire Me
                    </a>
                    <a href="https://www.linkedin.com/in/phani-kumar-jallipalli" target="_blank" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg transition duration-300">
                        View LinkedIn
                    </a>
                </div>
            </div>
        </section>

        <!-- 2. Skills Section -->
        <section id="skills" class="py-20">
            <h2 class="text-3xl font-bold section-header">Core Competencies & Skills</h2>

            <!-- Analytics & Tagging -->
            <h3 class="text-2xl font-semibold mt-8 mb-4 text-blue-300">Analytics Implementation & Management</h3>
            <div class="flex flex-wrap gap-3">
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Adobe Analytics</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">GA4 / Google Analytics</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Adobe Launch (Client & Server Side)</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Google Tag Manager (GTM)</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Data Layer Design & Optimization</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">CCPA/OneTrust Compliance</span>
            </div>

            <!-- Reporting & Data Science -->
            <h3 class="text-2xl font-semibold mt-8 mb-4 text-blue-300">Data & Engineering Tools</h3>
            <div class="flex flex-wrap gap-3">
                <span class="skill-badge bg-blue-900 text-white px-4 py-2 rounded-full text-sm font-medium">JavaScript (Expert)</span>
                <span class="skill-badge bg-blue-900 text-white px-4 py-2 rounded-full text-sm font-medium">Python</span>
                <span class="skill-badge bg-blue-900 text-white px-4 py-2 rounded-full text-sm font-medium">SQL</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Adobe Workspace</span>
                <span class="skill-badge bg-gray-700 text-white px-4 py-2 rounded-full text-sm font-medium">Looker Studio</span>
            </div>

            <!-- AI/ML & Development -->
            <h3 class="text-2xl font-semibold mt-8 mb-4 text-blue-300">Web Development & Machine Learning</h3>
            <div class="flex flex-wrap gap-3">
                <span class="skill-badge bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium">Vue.js</span>
                <span class="skill-badge bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium">Flask</span>
                <span class="skill-badge bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium">SKLEARN</span>
                <span class="skill-badge bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium">TensorFlow</span>
                <span class="skill-badge bg-gray-900 text-white px-4 py-2 rounded-full text-sm font-medium">Pandas / NumPy</span>
            </div>
        </section>

        <!-- 3. Certifications Section -->
        <section id="certifications" class="py-20">
            <h2 class="text-3xl font-bold section-header">Key Certifications</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                <div class="card p-6 rounded-xl border border-gray-700">
                    <p class="text-lg font-semibold text-blue-400">Adobe Certified Expert - Adobe Customer Journey Analytics Developer</p>
                    <p class="text-sm text-gray-400">Adobe | Issued April 2025</p>
                </div>
                <div class="card p-6 rounded-xl border border-gray-700">
                    <p class="text-lg font-semibold text-blue-400">Adobe Certified Expert - Adobe Analytics Developer</p>
                    <p class="text-sm text-gray-400">Adobe | Issued June 2024</p>
                </div>
                <div class="card p-6 rounded-xl border border-gray-700">
                    <p class="text-lg font-semibold text-blue-400">Google Analytics Certification</p>
                    <p class="text-sm text-gray-400">Google Digital Academy | Issued May 2024</p>
                </div>
                <div class="card p-6 rounded-xl border border-gray-700">
                    <p class="text-lg font-semibold text-blue-400">OneTrust Consent & Preference Management Expert</p>
                    <p class="text-sm text-gray-400">OneTrust | Issued May 2024</p>
                </div>
            </div>
        </section>

        <!-- 4. Experience Section -->
        <section id="experience" class="py-20">
            <h2 class="text-3xl font-bold section-header">Professional Experience</h2>
            <div class="space-y-12 mt-8">

                <!-- Job 1: Lenovo -->
                <div class="timeline-item">
                    <h3 class="text-xl font-semibold text-white">Senior Digital Analytics Developer</h3>
                    <p class="text-blue-400 font-medium">Lenovo (Full-time)</p>
                    <p class="text-sm text-gray-400 mb-3">Jul 2025 – Present | Bengaluru, India · Remote</p>
                    <ul class="list-disc ml-5 text-gray-300 text-sm space-y-2">
                        <li>Currently contributing to high-level analytics development and strategy for a global leader. (Placeholder based on future dated entry)</li>
                    </ul>
                </div>

                <!-- Job 2: Petco (Technical Lead) -->
                <div class="timeline-item">
                    <h3 class="text-xl font-semibold text-white">Technical Lead (Digital Analytics)</h3>
                    <p class="text-blue-400 font-medium">Petco (Full-time)</p>
                    <p class="text-sm text-gray-400 mb-3">Sep 2024 – Aug 2025 | Remote</p>
                    <ul class="list-disc ml-5 text-gray-300 text-sm space-y-2">
                        <li>Led a digital analytics team, delivering impactful business solutions.</li>
                        <li>Drove substantial ROI by collaborating with product teams to integrate a recommendation widget.</li>
                        <li>Unified customer data across platforms by implementing cross-device ECID stitching.</li>
                        <li>Provided strategic consulting and best practices as a Subject Matter Expert (SME) for Adobe Analytics.</li>
                        <li>Partnered with teams to develop BRDs, design SDRs, and write technical specifications.</li>
                    </ul>
                </div>

                <!-- Job 3: Petco (Consultant) -->
                <div class="timeline-item">
                    <h3 class="text-xl font-semibold text-white">Digital Analytics Consultant (Contractor)</h3>
                    <p class="text-blue-400 font-medium">Petco (Vivaan Consulting)</p>
                    <p class="text-sm text-gray-400 mb-3">Sep 2022 – Sep 2024</p>
                    <ul class="list-disc ml-5 text-gray-300 text-sm space-y-2">
                        <li>Successfully implemented and optimized tags using Adobe Launch and GTM for data collection.</li>
                        <li>Reduced GTM tags by <span class="font-bold text-green-400">75%</span> and consolidated Adobe Launch properties from 10 to 2, drastically enhancing efficiency.</li>
                        <li>Resolved <span class="font-bold text-green-400">80%</span> of data accuracy/integrity issues through strong debugging skills.</li>
                        <li>Implemented e-commerce marketing tags (Medallia, Facebook, Pinterest, etc.) to boost digital marketing performance.</li>
                        <li>Ensured regulatory compliance by implementing CCPA rules using OneTrust.</li>
                    </ul>
                </div>

                <!-- Job 4: Independent/Vivaan -->
                <div class="timeline-item">
                    <h3 class="text-xl font-semibold text-white">Web Developer and Digital Analytics Consultant (Freelance)</h3>
                    <p class="text-blue-400 font-medium">Independent Consultant / Vivaan Consulting</p>
                    <p class="text-sm text-gray-400 mb-3">Nov 2021 – Sep 2022</p>
                    <ul class="list-disc ml-5 text-gray-300 text-sm space-y-2">
                        <li>Designed and developed APIs using JavaScript to enhance web application functionality.</li>
                        <li>Authored technical specifications for seamless Mobile SDK implementations and configured GTM tags.</li>
                        <li>Developed a QA tool to streamline Adobe Launch debugging, improving project delivery quality.</li>
                        <li>Demonstrated complex problem-solving by developing intricate Regular Expression (Regex) functions.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 5. Projects Section -->
        <section id="projects" class="py-20">
            <h2 class="text-3xl font-bold section-header">Featured Projects</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">

                <!-- Project 1: Kanban Board -->
                <div class="card p-6 rounded-xl border border-gray-700">
                    <h3 class="text-xl font-semibold text-white mb-2">Kanban Board - Web Application</h3>
                    <p class="text-sm text-blue-400 mb-4">Full-Stack Development (Vue.js, Flask, SQLite)</p>
                    <p class="text-gray-400 text-sm mb-4">Developed a robust Kanban-Board application to streamline task management, showcasing proficiency in full-stack development and creating a dynamic, responsive UI.</p>
                    <div class="flex space-x-3 text-sm">
                        <a href="#" class="text-blue-400 hover:text-blue-300 font-medium">Frontend (Link)</a>
                        <a href="#" class="text-blue-400 hover:text-blue-300 font-medium">Backend (Link)</a>
                    </div>
                </div>

                <!-- Project 2: Retail Rice Store Case Study -->
                <div class="card p-6 rounded-xl border border-gray-700">
                    <h3 class="text-xl font-semibold text-white mb-2">Retail Store Case Study - BDM</h3>
                    <p class="text-sm text-blue-400 mb-4">Business Data Management & Reporting</p>
                    <p class="text-gray-400 text-sm mb-4">Conducted a comprehensive case study, analyzing sales and conversion data to identify better-performing brands and provide actionable strategic recommendations.</p>
                    <a href="#" class="text-blue-400 hover:text-blue-300 font-medium text-sm">View Report (Link)</a>
                </div>

                <!-- Project 3: Sentiment Prediction -->
                <div class="card p-6 rounded-xl border border-gray-700">
                    <h3 class="text-xl font-semibold text-white mb-2">Sentiment Prediction on Movie Reviews</h3>
                    <p class="text-sm text-blue-400 mb-4">Machine Learning (SKLEARN, Pandas)</p>
                    <p class="text-gray-400 text-sm mb-4">Foundational ML project focusing on sentiment prediction using Kaggle datasets, honing skills in algorithmic understanding, data analysis, and visualization.</p>
                    <a href="#" class="text-blue-400 hover:text-blue-300 font-medium text-sm">View Code (Link)</a>
                </div>

            </div>
        </section>

        <!-- 6. Contact Section -->
        <section id="contact" class="py-20">
            <h2 class="text-3xl font-bold section-header">Get in Touch</h2>
            
            <!-- Gemini Feature Integration: Analytics Strategy Brainstormer -->
            <div class="max-w-4xl mx-auto mt-12 p-8 card rounded-xl border border-blue-700/50 shadow-xl shadow-blue-900/50">
                <h3 class="text-2xl font-bold text-blue-300 mb-4 text-center">
                    ✨ Instant Analytics Strategy Brainstormer
                </h3>
                <p class="text-gray-400 mb-6 text-center text-sm">
                    Describe your business goal or platform (e.g., "e-commerce conversion optimization" or "SaaS free trial signups"), and Phani's AI Assistant will draft a starting strategy, grounded in modern best practices, demonstrating his expertise.
                </p>

                <textarea id="strategyInput" class="w-full h-24 p-4 rounded-lg bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="e.g., 'I run a high-traffic media site and need a strategy for ad impression and content consumption tracking.'"></textarea>

                <button id="generateStrategyBtn" class="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-300 transform hover:scale-[1.01] disabled:opacity-50">
                    Generate Strategy Outline
                </button>

                <!-- Loading & Output -->
                <div id="loadingIndicator" class="mt-6 text-center hidden">
                    <svg class="animate-spin h-6 w-6 text-blue-400 inline-block mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="text-gray-400">Drafting strategy... (This may take a moment)</span>
                </div>

                <div id="strategyOutput" class="mt-6 p-4 bg-gray-900 rounded-lg border border-gray-800 hidden">
                    <!-- Content generated by LLM will go here -->
                </div>
            </div>

            <!-- Existing Contact Info Section -->
            <div class="max-w-3xl mx-auto mt-10 p-8 card rounded-xl border border-gray-700">
                <p class="text-lg text-gray-300 mb-6 text-center">
                    I am actively seeking Digital Analytics and AI/ML project collaborations. Let's discuss how data can drive your business forward.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                    <div class="flex flex-col items-center">
                        <svg class="w-8 h-8 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                        <span class="text-sm font-medium">+91 8317566775</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <svg class="w-8 h-8 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        <span class="text-sm font-medium">Phani.jallipalli786@gmail.com</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <svg class="w-8 h-8 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                        <a href="https://www.linkedin.com/in/phani-kumar-jallipalli" target="_blank" class="text-sm font-medium hover:text-blue-300">LinkedIn Profile</a>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="mt-20 py-8 border-t border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Jallipalli Phani Kumar. All rights reserved. | Built for Digital Consulting.</p>
        </div>
    </footer>

    <!-- Simple Scroll Smoothing for Anchor Links -->
    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Gemini API Feature Logic
        document.addEventListener('DOMContentLoaded', () => {
            const generateStrategyBtn = document.getElementById('generateStrategyBtn');
            const strategyInput = document.getElementById('strategyInput');
            const strategyOutput = document.getElementById('strategyOutput');
            const loadingIndicator = document.getElementById('loadingIndicator');

            const API_KEY = ""; // Placeholder for the actual API key
            const MODEL = 'gemini-2.5-flash-preview-05-20';
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`;
            
            // --- Utility Functions ---

            // Function for exponential backoff retry logic
            async function fetchWithRetry(url, options, maxRetries = 5) {
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(url, options);
                        if (response.status === 429 && i < maxRetries - 1) {
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                            await new Promise(resolve => setTimeout(resolve, delay));
                            continue; // Retry
                        }
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response;
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            console.error("Fetch failed after max retries:", error);
                            throw error;
                        }
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        // Retry automatically continues the loop
                    }
                }
            }
            
            // Simple Markdown to HTML converter to display the strategy nicely
            const markdownToHtml = (markdown) => {
                let html = markdown;

                // 1. Convert bold section headers (like 1. **Title**) into styled H4 blocks
                // We use a specific regex to capture the strategy section structure and replace it with a marker
                html = html.replace(/(\d+\.\s*\*\*([^\*]+)\*\*)/g, (match, p1, p2) => {
                    return `@@HEADER@@${p2.trim()}`; 
                });
                
                // Convert temporary header marker to final HTML
                html = html.replace(/@@HEADER@@(.*?)/g, (match, p1) => {
                    return `<div class="mt-6 mb-2">
                        <h4 class="text-xl font-bold text-blue-400 border-b border-gray-700 pb-1">
                            ${p1.trim()}
                        </h4>
                    </div>`;
                });


                // 2. Convert remaining bold text
                html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

                // 3. Convert bullet lists (* or -) to <li> tags using a temporary marker
                // The 'm' flag allows '^' to match the start of a line
                html = html.replace(/^[\*\-]\s*(.*)$/gm, '@@LI@@$1');
                
                // 4. Wrap continuous blocks of LI markers in <ul> tags
                // This pattern finds one or more '@@LI@@' lines
                html = html.replace(/(@@LI@@[^\n]*\n*)+/g, (match) => {
                    // Convert the block of markers into proper <ul>/<li>
                    const listItems = match.split('\n').filter(line => line.startsWith('@@LI@@'))
                        .map(line => `<li>${line.replace('@@LI@@', '').trim()}</li>`).join('');
                    
                    if (listItems.trim() === "") return ""; // Avoid empty lists
                    
                    return `<ul class="list-disc ml-5 space-y-1 text-sm text-gray-300 mb-4">${listItems}</ul>\n\n`;
                });

                // 5. Convert remaining double newlines to paragraph breaks
                html = html.replace(/\n\n/g, '</p><p class="text-gray-300 text-sm mt-3">');

                // 6. Wrap content that starts the text in a starting <p> and close the last one
                html = `<p class="text-gray-300 text-sm mt-3">${html}</p>`;
                
                // 7. Cleanup extra surrounding p tags around the custom headers and lists
                html = html.replace(/<p class="text-gray-300 text-sm mt-3">\s*<div/g, '<div');
                html = html.replace(/<\/div>\s*<\/p>/g, '</div>');
                html = html.replace(/<p class="text-gray-300 text-sm mt-3">\s*<ul/g, '<ul');
                html = html.replace(/<\/ul>\s*<\/p>/g, '</ul>');
                html = html.replace(/(<p[^>]*>)?\s*<\/p>/g, ''); // Remove empty paragraphs
                html = html.replace(/\n/g, ''); // Remove any leftover newlines

                return html.trim();
            };


            async function generateStrategy() {
                const userQuery = strategyInput.value.trim();
                if (!userQuery) {
                    strategyOutput.innerHTML = '<p class="text-red-400">Please describe your business goal or platform first.</p>';
                    strategyOutput.classList.remove('hidden');
                    return;
                }

                generateStrategyBtn.disabled = true;
                strategyOutput.classList.add('hidden');
                loadingIndicator.classList.remove('hidden');
                
                const systemPrompt = `You are a world-class Digital Analytics Consultant, acting as Phani Jallipalli. Your goal is to draft a high-level initial analytics strategy outline based on the user's business goal. 
                The strategy must be structured clearly under these three headings:
                1. **Data Layer & Tagging Strategy (Focusing on Adobe Launch/GTM)**: How should the data be structured and what technologies are needed?
                2. **Core Measurement KPIs (Focusing on GA4/Adobe Analytics)**: What metrics should be tracked to measure success?
                3. **Actionable Insights & Next Steps (Focusing on Reporting/ML Potential)**: How can this data be used to drive business decisions or lead into ML projects?
                
                Keep the response professional, concise, and formatted using Markdown headers and bullet points. Mention the need for detailed documentation (SDRs/BRDs).`;
                
                const fullPrompt = `Business Goal/Platform Description: "${userQuery}". Based on this, draft the initial high-level digital analytics strategy outline.`;

                const payload = {
                    contents: [{ parts: [{ text: fullPrompt }] }],
                    // Using Google Search grounding to ensure the strategy is based on current industry best practices.
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                try {
                    const response = await fetchWithRetry(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        let text = candidate.content.parts[0].text;
                        let sourcesHtml = '';

                        // Extract grounding sources
                        const groundingMetadata = candidate.groundingMetadata;
                        let sources = [];
                        if (groundingMetadata && groundingMetadata.groundingAttributions) {
                            sources = groundingMetadata.groundingAttributions
                                .map(attribution => ({
                                    uri: attribution.web?.uri,
                                    title: attribution.web?.title,
                                }))
                                .filter(source => source.uri && source.title);
                        }

                        if (sources.length > 0) {
                            sourcesHtml = '<p class="text-xs text-gray-500 mt-4 border-t border-gray-700 pt-2">Sources for Grounding:</p><ul class="list-disc ml-5 text-gray-500 text-xs">';
                            sources.slice(0, 3).forEach((source, index) => {
                                 // Only display the top 3 sources for conciseness
                                sourcesHtml += `<li><a href="${source.uri}" target="_blank" class="hover:text-blue-400 transition">${source.title || 'Source ' + (index + 1)}</a></li>`;
                            });
                            sourcesHtml += '</ul>';
                        }

                        // Render markdown to HTML
                        strategyOutput.innerHTML = `<h3 class="text-xl font-bold mb-3 text-white">Proposed Strategy Outline</h3>${markdownToHtml(text)}` + sourcesHtml;
                        strategyOutput.classList.remove('hidden');

                    } else {
                        strategyOutput.innerHTML = '<p class="text-red-400">Sorry, the AI assistant could not generate a strategy. Please try rephrasing your goal.</p>';
                        strategyOutput.classList.remove('hidden');
                    }

                } catch (error) {
                    console.error("Gemini API call failed:", error);
                    strategyOutput.innerHTML = '<p class="text-red-400">An error occurred during API communication. Check the console for details.</p>';
                    strategyOutput.classList.remove('hidden');
                } finally {
                    loadingIndicator.classList.add('hidden');
                    generateStrategyBtn.disabled = false;
                }
            }

            // Attach event listener to the button
            generateStrategyBtn.addEventListener('click', generateStrategy);
        });
    </script>
</body>
</html>
